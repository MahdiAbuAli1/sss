
?[32mINFO?[0m:     Will watch for changes in these directories: ['C:\\Users\\mahdi\\support_service_platform']
?[32mINFO?[0m:     Uvicorn running on ?[1mhttp://127.0.0.1:8000?[0m (Press CTRL+C to quit)
?[32mINFO?[0m:     Started reloader process [?[36m?[1m393332?[0m] using ?[36m?[1mWatchFiles?[0m
C:\Users\mahdi\AppData\Local\miniconda3\envs\test_env\lib\site-packages\langchain\retrievers\__init__.py:46: LangChainDeprecationWarning:
Importing this retriever from langchain is deprecated. Importing it from langchain will no longer be supported as of langchain==0.2.0. Ple
ase import from langchain-community instead:

`from langchain_community.retrievers import BM25Retriever`.

To install langchain-community run `pip install -U langchain-community`.
  warnings.warn(
?[32mINFO?[0m:     Started server process [?[36m411924?[0m]
?[32mINFO?[0m:     Waiting for application startup.
2025-10-29 09:38:30,069 - INFO -  بدء تشغيل خادم الـ API...
2025-10-29 09:38:30,070 - INFO -  تهيئة الوكيل ستعمل في الخلفية...
2025-10-29 09:38:30,071 - INFO - بدء تهيئة النماذج وقاعدة البيانات الموحدة...
?[32mINFO?[0m:     Application startup complete.
2025-10-29 09:38:30,496 - INFO - HTTP Request: GET http://127.0.0.1:11434 "HTTP/1.1 200 OK"
2025-10-29 09:38:30,519 - INFO - Loading faiss with AVX2 support.
2025-10-29 09:38:31,106 - INFO - Successfully loaded faiss with AVX2 support.
2025-10-29 09:38:31,229 - INFO - ✅ الوكيل جاهز للعمل بقاعدة بيانات موحدة.
?[32mINFO?[0m:     127.0.0.1:1466 - "?[1mGET /chat HTTP/1.1?[0m" ?[32m200 OK?[0m
?[32mINFO?[0m:     127.0.0.1:1466 - "?[1mGET /tenants HTTP/1.1?[0m" ?[32m200 OK?[0m
?[32mINFO?[0m:     127.0.0.1:1466 - "?[1mGET /favicon.ico HTTP/1.1?[0m" ?[31m404 Not Found?[0m
?[32mINFO?[0m:     127.0.0.1:8129 - "?[1mPOST /ask-stream HTTP/1.1?[0m" ?[32m200 OK?[0m
2025-10-29 09:41:34,424 - INFO - ⏱️ بدء المرحلة: total_request | العميل: sys
2025-10-29 09:41:34,425 - INFO - [sys] استخدام ملف شخصي لإعادة صياغة السؤال للعميل 'sys'.
2025-10-29 09:43:03,549 - INFO - [sys] السؤال الأصلي: 'كيف ابدا' -> السؤال المحسّن: '**استعلام محسّن:**
`SELECT * FROM [نظام إدارة طلبات الاعتماد] WHERE [مصدر الطلب] = 'طلب اعتماد' AND [مرحلة التحقق] = 'قوائم التحقق' AND [المرحلة الأولى] = 'ا
لاستعداد للتقديم'`

**الشرح:**
- **طلب اعتماد**: يُشير إلى المرحلة الأولى من العملية (التقديم).
- **قوائم التحقق**: تُعتبر المرحلة الثانية (التحقق من البيانات).
- **المرحلة الأولى**: تُحدد الخطوات المطلوبة في بداية العملية (مثل إعداد الوثائق).

**الهدف:**
استعلام عن الخطوات الأولية في عملية الحصول على الاعتماد، مع التركيز على المراحل الأولى (التقديم والتحقق من البيانات) وتحديد المهام المطلوب
ة (مثل إعداد قوائم التحقق).'
2025-10-29 09:43:03,571 - INFO - [sys] بدء معالجة السؤال '**استعلام محسّن:**
`SELECT * FROM [نظام إدارة طلبات الاعتماد] WHERE [مصدر الطلب] = 'طلب اعتماد' AND [مرحلة التحقق] = 'قوائم التحقق' AND [المرحلة الأولى] = 'ا
لاستعداد للتقديم'`

**الشرح:**
- **طلب اعتماد**: يُشير إلى المرحلة الأولى من العملية (التقديم).
- **قوائم التحقق**: تُعتبر المرحلة الثانية (التحقق من البيانات).
- **المرحلة الأولى**: تُحدد الخطوات المطلوبة في بداية العملية (مثل إعداد الوثائق).

**الهدف:**
استعلام عن الخطوات الأولية في عملية الحصول على الاعتماد، مع التركيز على المراحل الأولى (التقديم والتحقق من البيانات) وتحديد المهام المطلوب
ة (مثل إعداد قوائم التحقق).'...
2025-10-29 09:43:03,571 - INFO - ⏱️ بدء المرحلة: llm_stream_generation | العميل: sys
2025-10-29 09:45:05,978 - WARNING - ⚠️ محاولة إنهاء مرحلة 'llm_stream_generation' لم يتم بدؤها أو تم إنهاؤها بالفعل.
2025-10-29 09:45:05,979 - INFO - [sys] الإجابة الكاملة: 'الإجابة:
استعلامك يُظهر الخطوات الأولية في عملية الحصول على الاعتماد، حيث يُحدد المراحل (التقديم والتحقق من البيانات) ومهام مثل إعداد قوائم التحقق.

- **المرحلة الأولى (التقديم)**: تشمل إعداد الوثائق والتأكد من توافق البيانات.
- **المرحلة الثانية (التحقق من البيانات)**: تشمل تأكيد المعلومات ورفع النماذج المُعتمدة.
الاستعلام يُساعد في توثيق الخطوات المطلوبة في بداية العملية، وتحديد المهام المُستفادة من النظام.'
2025-10-29 09:45:05,979 - WARNING - ⚠️ محاولة إنهاء مرحلة 'total_request' لم يتم بدؤها أو تم إنهاؤها بالفعل.
?[32mINFO?[0m:     127.0.0.1:4491 - "?[1mPOST /ask-stream HTTP/1.1?[0m" ?[32m200 OK?[0m
2025-10-29 09:45:21,851 - INFO - ⏱️ بدء المرحلة: total_request | العميل: sys
2025-10-29 09:45:21,851 - INFO - [sys] استخدام ملف شخصي لإعادة صياغة السؤال للعميل 'sys'.
2025-10-29 09:47:02,533 - INFO - [sys] السؤال الأصلي: 'ماهو هذا النظام' -> السؤال المحسّن: '**استعلام محسّن:**
```sql
SELECT * FROM sistemas WHERE
    nombre = 'نظام إدارة طلب الاعتماد' AND
    descripcion LIKE '%تتبع مراحل الحصول على الاعتماد من التقديم حتى إصدار الشهادة%' AND
    clave_incluida = 'طلب اعتماد' AND
    clave_incluida = 'قوائم التحقق' AND
    clave_incluida = 'دراسة مكتبية' AND
    clave_incluida = 'زيارة ميدانية' AND
    clave_incluida = 'إجراءات تصحيحية';
```

**الشرح:**
- **العنوان:** يحدد النظام بوضوح.
- **الوصف:** يبحث عن النظام في القاعدة بحسب الوصف المحدد (التتبع من التقديم إلى إصدار الشهادة).
- **المصطلحات الهامة:** تُستخدم لتحديد المكونات الرئيسية (طلب الاعتماد، القوائم التحقق، الدراسة المكتبية، الزيارة الميدانية، الإجراءات الت
صحيحية).
- **الهدف:** يُساعد في إيجاد النظام في القاعدة التقنية بسرعة ودقة.'
2025-10-29 09:47:02,540 - INFO - [sys] بدء معالجة السؤال '**استعلام محسّن:**
```sql
SELECT * FROM sistemas WHERE
    nombre = 'نظام إدارة طلب الاعتماد' AND
    descripcion LIKE '%تتبع مراحل الحصول على الاعتماد من التقديم حتى إصدار الشهادة%' AND
    clave_incluida = 'طلب اعتماد' AND
    clave_incluida = 'قوائم التحقق' AND
    clave_incluida = 'دراسة مكتبية' AND
    clave_incluida = 'زيارة ميدانية' AND
    clave_incluida = 'إجراءات تصحيحية';
```

**الشرح:**
- **العنوان:** يحدد النظام بوضوح.
- **الوصف:** يبحث عن النظام في القاعدة بحسب الوصف المحدد (التتبع من التقديم إلى إصدار الشهادة).
- **المصطلحات الهامة:** تُستخدم لتحديد المكونات الرئيسية (طلب الاعتماد، القوائم التحقق، الدراسة المكتبية، الزيارة الميدانية، الإجراءات الت
صحيحية).
- **الهدف:** يُساعد في إيجاد النظام في القاعدة التقنية بسرعة ودقة.'...
2025-10-29 09:47:02,540 - INFO - ⏱️ بدء المرحلة: llm_stream_generation | العميل: sys
?[32mINFO?[0m:     127.0.0.1:10138 - "?[1mGET / HTTP/1.1?[0m" ?[32m200 OK?[0m
2025-10-29 09:49:49,331 - WARNING - ⚠️ محاولة إنهاء مرحلة 'llm_stream_generation' لم يتم بدؤها أو تم إنهاؤها بالفعل.
2025-10-29 09:49:49,331 - INFO - [sys] الإجابة الكاملة: 'بحثت في قاعدة المعرفة، ولكن لم أجد إجابة واضحة بخصوص هذا السؤال.'
2025-10-29 09:49:49,357 - WARNING - ⚠️ محاولة إنهاء مرحلة 'total_request' لم يتم بدؤها أو تم إنهاؤها بالفعل.
?[32mINFO?[0m:     127.0.0.1:5520 - "?[1mPOST /ask-stream HTTP/1.1?[0m" ?[32m200 OK?[0m
2025-10-29 09:50:47,472 - INFO - ⏱️ بدء المرحلة: total_request | العميل: sys
2025-10-29 09:50:47,472 - INFO - [sys] استخدام ملف شخصي لإعادة صياغة السؤال للعميل 'sys'.
2025-10-29 09:51:37,078 - INFO - [sys] السؤال الأصلي: 'من انت' -> السؤال المحسّن: '**الاستعلام المحسّن:**
`/search?q=ما هي مهام نظام إدارة طلبات الاعتماد في تطبيق قوائم التحقق، دراسة مكتبية، زيارة ميدانية، وإجراءات تصحيحية؟`

**الشرح:**
- تستخدم المصطلحات الهامة (`قوائم التحقق، دراسة مكتبية، زيارة ميدانية، إجراءات تصحيحية`) لتحديد المهام والإجراءات التي يُتعامل معها النظام
.
- السؤال يركز على **وظيفة النظام** في مراحل الحصول على الاعتماد، مما يُناسب استخدامه في قاعدة بيانات تقنية لاستخراج معلومات محددة عن النظا
م.'
2025-10-29 09:51:37,086 - INFO - [sys] بدء معالجة السؤال '**الاستعلام المحسّن:**
`/search?q=ما هي مهام نظام إدارة طلبات الاعتماد في تطبيق قوائم التحقق، دراسة مكتبية، زيارة ميدانية، وإجراءات تصحيحية؟`

**الشرح:**
- تستخدم المصطلحات الهامة (`قوائم التحقق، دراسة مكتبية، زيارة ميدانية، إجراءات تصحيحية`) لتحديد المهام والإجراءات التي يُتعامل معها النظام
.
- السؤال يركز على **وظيفة النظام** في مراحل الحصول على الاعتماد، مما يُناسب استخدامه في قاعدة بيانات تقنية لاستخراج معلومات محددة عن النظا
م.'...
2025-10-29 09:51:37,086 - INFO - ⏱️ بدء المرحلة: llm_stream_generation | العميل: sys
2025-10-29 09:54:56,646 - WARNING - ⚠️ محاولة إنهاء مرحلة 'llm_stream_generation' لم يتم بدؤها أو تم إنهاؤها بالفعل.
2025-10-29 09:54:56,650 - INFO - [sys] الإجابة الكاملة: 'الإجابة:
في نظام إدارة طلبات الاعتماد، تُستخدم مهامه في مراحل التقييم والتصحيح كما يلي:
1. **رفع تقرير التحقق**: يُرفع تقرير التحقق إلى الجهة المختصة للاعتماد، ويُدرس ويتخذ قرارًا فيه.
2. **الدراسة المكتبية**: تُدرس دراسة مكتبية تُقدم من الجهة المختصة لتأكيد مطابقة الطلب مع المعايير.
3. **زيارة ميدانية**: تُطلب زيارة ميدانية لتأكيد تنفيذ الإجراءات التصحيحية وضمان المطابقة.
4. **إجراءات تصحيحية**: تُُتخذ إجراءات تصحيحية إذا ما وُجدت ملاحظات على التحقق، وتُعاد طلب الإجراءات مرة أخرى.

هذا يعكس دور النظام في إدارة طلبات الاعتماد من خلال مراحل التقييم والتصحيح المطلوبة.'
2025-10-29 09:54:56,653 - WARNING - ⚠️ محاولة إنهاء مرحلة 'total_request' لم يتم بدؤها أو تم إنهاؤها بالفعل.
?[32mINFO?[0m:     127.0.0.1:3762 - "?[1mPOST /ask-stream HTTP/1.1?[0m" ?[32m200 OK?[0m
2025-10-29 09:55:14,457 - INFO - ⏱️ بدء المرحلة: total_request | العميل: sys
2025-10-29 09:55:14,458 - INFO - [sys] استخدام ملف شخصي لإعادة صياغة السؤال للعميل 'sys'.
2025-10-29 09:57:14,368 - INFO - [sys] السؤال الأصلي: 'كيف اقوم بتسجيل الدخول' -> السؤال المحسّن: '**استعلام بحث دقيق:**
"كيف يمكنني تسجيل الدخول إلى نظام إدارة طلبات الاعتماد"

**التحليل:**
- **العنوان:** يشير إلى المهمة (تسجيل الدخول) واسم النظام (نظام إدارة طلبات الاعتماد) بشكل مباشر.
- **العناصر المهمة:**
  - **طلب اعتماد:** يُشير إلى مراحل النظام (التقديم حتى الإصدار).
  - **قوائم التحقق:** تُظهر أن النظام يحتوي على أدوات تحقق.
  - **إجراءات تصحيحية:** تُظهر أن هناك إجراءات لتعديل البيانات.
- **الهدف:** إنشاء استعلام يبحث عن إجراءات تسجيل الدخول في النظام، مع تضمين العناصر المهمة لاستخراج معلومات دقيقة.

**الاستعلام النهائي:**
"كيف يمكنني تسجيل الدخول إلى نظام إدارة طلبات الاعتماد"'
2025-10-29 09:57:14,376 - INFO - [sys] بدء معالجة السؤال '**استعلام بحث دقيق:**
"كيف يمكنني تسجيل الدخول إلى نظام إدارة طلبات الاعتماد"

**التحليل:**
- **العنوان:** يشير إلى المهمة (تسجيل الدخول) واسم النظام (نظام إدارة طلبات الاعتماد) بشكل مباشر.
- **العناصر المهمة:**
  - **طلب اعتماد:** يُشير إلى مراحل النظام (التقديم حتى الإصدار).
  - **قوائم التحقق:** تُظهر أن النظام يحتوي على أدوات تحقق.
  - **إجراءات تصحيحية:** تُظهر أن هناك إجراءات لتعديل البيانات.
- **الهدف:** إنشاء استعلام يبحث عن إجراءات تسجيل الدخول في النظام، مع تضمين العناصر المهمة لاستخراج معلومات دقيقة.

**الاستعلام النهائي:**
"كيف يمكنني تسجيل الدخول إلى نظام إدارة طلبات الاعتماد"'...
2025-10-29 09:57:14,376 - INFO - ⏱️ بدء المرحلة: llm_stream_generation | العميل: sys
2025-10-29 09:59:57,079 - WARNING - ⚠️ محاولة إنهاء مرحلة 'llm_stream_generation' لم يتم بدؤها أو تم إنهاؤها بالفعل.
2025-10-29 09:59:57,080 - INFO - [sys] الإجابة الكاملة: 'بحثت في قاعدة المعرفة، ولكن لم أجد إجابة واضحة بخصوص هذا السؤال.'
2025-10-29 09:59:57,080 - WARNING - ⚠️ محاولة إنهاء مرحلة 'total_request' لم يتم بدؤها أو تم إنهاؤها بالفعل.
?[32mINFO?[0m:     127.0.0.1:5025 - "?[1mPOST /ask-stream HTTP/1.1?[0m" ?[32m200 OK?[0m
2025-10-29 10:00:40,654 - INFO - ⏱️ بدء المرحلة: total_request | العميل: un
2025-10-29 10:00:40,655 - INFO - [un] استخدام ملف شخصي لإعادة صياغة السؤال للعميل 'un'.
2025-10-29 10:02:48,502 - INFO - [un] السؤال الأصلي: 'كيف اقوم بتسجيل الدخول' -> السؤال المحسّن: '**استعلام محسّن:**
`how to login to unops eprocurement`
**التفاصيل:**
- استخدام المصطلحات الهامة: **تسجيل الدخول** (login), **UNOPS** (بوابة المشتريات الإلكترونية للأمم المتحدة), **مناقصات** (procurement), **
عطاءات** (submissions), **esourcing** (الاستثمار الإلكتروني).
- التركيز على الإجراءات الأساسية للتسجيل، مثل: "steps to register for unops", "process of logging into unops eprocurement", أو "how to acc
ess unops procurement portal".

**الاستعلام النهائي:**
`how to login to unops eprocurement`
**الوصف:**
استعلام دقيق لاستخدام نظام **UNOPS eProcurement**، مع التركيز على إجراءات التسجيل والدخول، وربطه بالمصطلحات الهامة مثل **مناقصات** و**عطاء
ات** و**esourcing**.'
2025-10-29 10:02:48,515 - INFO - [un] بدء معالجة السؤال '**استعلام محسّن:**
`how to login to unops eprocurement`
**التفاصيل:**
- استخدام المصطلحات الهامة: **تسجيل الدخول** (login), **UNOPS** (بوابة المشتريات الإلكترونية للأمم المتحدة), **مناقصات** (procurement), **
عطاءات** (submissions), **esourcing** (الاستثمار الإلكتروني).
- التركيز على الإجراءات الأساسية للتسجيل، مثل: "steps to register for unops", "process of logging into unops eprocurement", أو "how to acc
ess unops procurement portal".

**الاستعلام النهائي:**
`how to login to unops eprocurement`
**الوصف:**
استعلام دقيق لاستخدام نظام **UNOPS eProcurement**، مع التركيز على إجراءات التسجيل والدخول، وربطه بالمصطلحات الهامة مثل **مناقصات** و**عطاء
ات** و**esourcing**.'...
2025-10-29 10:02:48,518 - INFO - ⏱️ بدء المرحلة: llm_stream_generation | العميل: un
2025-10-29 10:06:07,654 - WARNING - ⚠️ محاولة إنهاء مرحلة 'llm_stream_generation' لم يتم بدؤها أو تم إنهاؤها بالفعل.
2025-10-29 10:06:07,664 - INFO - [un] الإجابة الكاملة: 'لإيجاد إجابة دقيقة، إليك الخطوات الأساسية لتسجيل الدخول إلى بوابة **UNOPS eProcure
ment**:

1. **الوصول إلى بوابة UNOPS**
   اذهب إلى الموقع الرسمي: [www.ungm.org](https://www.ungm.org) وابدأ بتسجيل الدخول.

2. **التسجيل**
   - اضغط على قسم "التسجيل" (Registration) على الشاشة.
   - أدخل البريد الإلكتروني والرمز المرور الذي تستخدمه في نظام الشراء الإلكتروني لمكتب الأمم المتحدة لخدمات المشاريع.
   - اضغط على "تسجيل الدخول" (Login) لتأكيد التسجيل.

3. **التحقق من المعرفة**
   - تأكد من أن البريد الإلكتروني والرمز المرور مُستخدما في نظام الشراء الإلكتروني لمكتب الأمم المتحدة.
   - إذا كنت مسجلة من قبل، اتحقق من تحديثات المعرفة (البيانات المُستخدمة في التسجيل).

4. **الدخول إلى النظام**
   - بعد التحقق، يمكنك الدخول إلى نظام الشراء الإلكتروني عبر البريد الإلكتروني والرمز المرور المُستخدما.
   - تأكد من أن المعرفة (البيانات) مُكتملة وقابلة للتطبيق.

**ملاحظة:**
الإجراءات مُبنية على نظام الشراء الإلكتروني لمكتب الأمم المتحدة لخدمات المشاريع، وتحتاج إلى تأكيد المعرفة (البيانات) عند الدخول.'
2025-10-29 10:06:07,688 - WARNING - ⚠️ محاولة إنهاء مرحلة 'total_request' لم يتم بدؤها أو تم إنهاؤها بالفعل.
?[32mINFO?[0m:     127.0.0.1:5025 - "?[1mPOST /ask-stream HTTP/1.1?[0m" ?[32m200 OK?[0m
2025-10-29 10:06:10,117 - INFO - ⏱️ بدء المرحلة: total_request | العميل: un
2025-10-29 10:06:10,118 - INFO - [un] استخدام ملف شخصي لإعادة صياغة السؤال للعميل 'un'.
2025-10-29 10:07:59,430 - INFO - [un] السؤال الأصلي: 'منهو البيضة' -> السؤال المحسّن: '**استعلام محسّن:**
`/search?q=مناقصات+و+تسجيل+الدخول+و+عطاءات+UNOPS+esourcing`

**الشرح:**
- تُستخدم المصطلحات الهامة (`مناقصات`, `تسجيل الدخول`, `عطاءات`, `UNOPS`, `esourcing`) لبحث عن معلومات متعلقة بالعلاقة بين **المناقصات** و
**التسجيل الدخلي** و**العطاءات** في نظام **UNOPS**.
- السؤال "منهو البيضة" يُعد مصطلحًا غير مباشرًا في سياق النظام، لكن الاستعلام يُركز على محتوى النظام ووظائفه، وليس على مفهوم "البيض" بشكل
مباشر.'
2025-10-29 10:07:59,449 - INFO - [un] بدء معالجة السؤال '**استعلام محسّن:**
`/search?q=مناقصات+و+تسجيل+الدخول+و+عطاءات+UNOPS+esourcing`

**الشرح:**
- تُستخدم المصطلحات الهامة (`مناقصات`, `تسجيل الدخول`, `عطاءات`, `UNOPS`, `esourcing`) لبحث عن معلومات متعلقة بالعلاقة بين **المناقصات** و
**التسجيل الدخلي** و**العطاءات** في نظام **UNOPS**.
- السؤال "منهو البيضة" يُعد مصطلحًا غير مباشرًا في سياق النظام، لكن الاستعلام يُركز على محتوى النظام ووظائفه، وليس على مفهوم "البيض" بشكل
مباشر.'...
2025-10-29 10:07:59,450 - INFO - ⏱️ بدء المرحلة: llm_stream_generation | العميل: un
2025-10-29 10:13:25,120 - WARNING - ⚠️ محاولة إنهاء مرحلة 'llm_stream_generation' لم يتم بدؤها أو تم إنهاؤها بالفعل.
2025-10-29 10:13:25,192 - INFO - [un] الإجابة الكاملة: 'بحثت في قاعدة المعرفة، ولكن لم أجد إجابة واضحة بخصوص هذا السؤال.'
2025-10-29 10:13:25,192 - WARNING - ⚠️ محاولة إنهاء مرحلة 'total_request' لم يتم بدؤها أو تم إنهاؤها بالفعل