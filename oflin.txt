بالتأكيد. لقد وصلت إلى المرحلة النهائية والممتعة. إليك الدليل المفصل خطوة بخطوة، من الصفر حتى تشغيل نظامك بالكامل على الجهاز الجديد غير المتصل بالإنترنت.

اطبع هذه التعليمات أو احفظها على هاتفك لتكون مرجعك هناك.

---

### **دليل الإعداد الكامل على الجهاز الجديد (Offline)**

**الهدف:** تثبيت كل شيء من مجلد `ai` وتشغيل تطبيقك بنجاح.

**المرحلة الأولى: تثبيت الأدوات الأساسية (بالترتيب)**

1.  **انسخ المجلد `ai`** من القرص الخارجي إلى سطح المكتب على الجهاز الجديد.

2.  **ثبّت 7-Zip:**
    *   افتح مجلد `ai` وابحث عن مثبت `7-Zip` (مثلاً `7z...exe`).
    *   قم بتثبيته. هذا ضروري لفك ضغط الملفات الأخرى.

3.  **ثبّت Miniconda:**
    *   من مجلد `ai`، قم بتشغيل مثبت `Miniconda` (مثلاً `Miniconda3...exe`).
    *   اتبع التعليمات، واترك الإعدادات الافتراضية كما هي (خاصة خيار "Install for me only").

4.  **ثبّت Ollama:**
    *   من مجلد `ai`، قم بتشغيل `OllamaSetup.exe`.
    *   سيتم التثبيت بسرعة.

5.  **ثبّت Tesseract OCR:**
    *   من مجلد `ai`، قم بتشغيل مثبت `tesseract-ocr...exe`.
    *   **خطوة حاسمة:** أثناء التثبيت، ستظهر لك شاشة "Choose Components". انزل للأسفل وافتح قائمة "Additional language data".
    *   ابحث عن **Arabic** وضع علامة صح بجانبها.
    *   أكمل التثبيت.

**المرحلة الثانية: استعادة البيئات والنماذج**

6.  **استعادة نماذج Ollama:**
    *   افتح مستكشف الملفات واذهب إلى `C:\Users\YourUsername` (استبدل `YourUsername` باسم المستخدم على الجهاز الجديد).
    *   ابحث عن مجلد `.ollama` الذي أنشأه التثبيت (سيكون فارغاً). **احذفه**.
    *   ارجع إلى مجلد `ai` على سطح المكتب.
    *   انقر بزر الماوس الأيمن على ملف `.ollama.rar` (أو `.ollama.7z`).
    *   اختر "7-Zip" -> "Extract Here" (استخراج هنا).
    *   سيظهر مجلد `.ollama` جديد ممتلئ بالملفات.
    *   **انقل** هذا المجلد إلى `C:\Users\YourUsername`.

7.  **استعادة بيئة Conda:**
    *   افتح "Anaconda Prompt" من قائمة "ابدأ" (Start Menu).
    *   اذهب إلى مجلد البيئات داخل Miniconda بالأمر التالي:
        ```bash
        cd C:\Users\YourUsername\miniconda3\envs
        ```
    *   الآن، سنقوم بفك ضغط ملف البيئة الذي أحضرته. استخدم الأمر التالي (تأكد من تعديل المسار إذا لزم الأمر):
        ```bash
        tar -xzf "%USERPROFILE%\Desktop\ai\support_env.tar"
        ```
    *   انتظر حتى ينتهي الأمر. سيقوم بإنشاء مجلد جديد اسمه `support_env` داخل مجلد `envs`.

**المرحلة الثالثة: الإعداد النهائي والتشغيل**

8.  **إعداد Poppler:**
    *   اذهب إلى مجلد `ai` على سطح المكتب.
    *   انسخ مجلد `Release-25.07.0-0` بالكامل.
    *   اذهب إلى القرص المحلي `C:\` والصق المجلد هناك. (ليصبح المسار `C:\Release-25.07.0-0`).
    *   **مهم:** افتح المجلد `C:\Release-25.07.0-0` ثم افتح مجلد `bin`. انسخ هذا المسار بالكامل (سيكون `C:\Release-25.07.0-0\bin`). ستحتاجه غالباً لإضافته في كود بايثون الخاص بك ليتمكن من العثور على الأداة.

9.  **الاختبار والتأكيد:**
    *   افتح نافذة Anaconda Prompt **جديدة**.
    *   **اختبر Ollama:** اكتب `ollama list`. يجب أن ترى نماذج `qwen3` الخاصة بك. إذا ظهرت، فالمرحلة تمت بنجاح.
    *   **اختبر Conda:** اكتب `conda env list`. يجب أن ترى `support_env` في القائمة.

10. **تشغيل التطبيق (لحظة الحقيقة):**
    *   في نفس نافذة Anaconda Prompt، قم بتفعيل بيئتك:
        ```bash
        conda activate support_env
        ```
        (ستلاحظ تغير الاسم في بداية السطر إلى `(support_env)`).
    *   اذهب إلى مجلد الكود الخاص بك:
        ```bash
        cd "%USERPROFILE%\Desktop\ai\support_service_platform"
        ```
    *   **شغّل تطبيقك** بنفس الأمر الذي تستخدمه عادة (مثلاً `python main.py` أو `uvicorn main:app --reload`).

بهذه الخطوات، يجب أن يعمل كل شيء كما كان على جهازك الأصلي. لقد قمت بكل التحضيرات اللازمة لضمان نجاح هذه العملية. رحلة موفقة



بالتأكيد، فهمت طلبك تماماً. أنت تريد دليلاً مفصلاً "للقص واللصق" (Copy-Paste) يحتوي على كل أمر تحتاجه لتجهيز البيئة وOllama من الصفر على الجهاز الجديد.

إليك الخطة الكاملة مع جميع الأوامر الدقيقة التي ستحتاجها.

---

### **الدليل التفصيلي الشامل للإعداد على الجهاز الجديد (مع كل الأوامر)**

**الافتراضات:**
*   لقد نسخت مجلد `ai` بالكامل إلى سطح المكتب (`Desktop`) على الجهاز الجديد.
*   اسم المستخدم على الجهاز الجديد هو `YourUsername`. (سأذكرك باستبداله).

---

#### **المرحلة الأولى: التثبيت الصامت (لا تحتاج أوامر هنا)**

1.  **تثبيت 7-Zip:**
    *   اذهب إلى `Desktop\ai`.
    *   شغّل مثبت `7-Zip` (مثلاً `7z...exe`).
    *   اضغط "Install" ثم "Close". (انتهى).

2.  **تثبيت Miniconda:**
    *   اذهب إلى `Desktop\ai`.
    *   شغّل `Miniconda3...exe`.
    *   اتبع التعليمات، وافق على الشروط، واترك كل الخيارات الافتراضية كما هي. (انتهى).

3.  **تثبيت Ollama:**
    *   اذهب إلى `Desktop\ai`.
    *   شغّل `OllamaSetup.exe`.
    *   سيتم التثبيت في الخلفية. (انتهى).

4.  **تثبيت Tesseract OCR:**
    *   اذهب إلى `Desktop\ai`.
    *   شغّل `tesseract-ocr...exe`.
    *   اتبع التعليمات، وعندما تصل إلى شاشة "Choose Components"، انزل للأسفل، افتح "Additional language data"، وابحث عن **Arabic** وضع علامة صح بجانبها. أكمل التثبيت. (انتهى).

---

#### **المرحلة الثانية: تجهيز البيئة والنماذج (هنا تبدأ الأوامر)**

**ملاحظة:** افتح قائمة ابدأ (Start Menu) وابحث عن "Anaconda Prompt" وقم بتشغيله. **ستنفذ كل الأوامر التالية في هذه النافذة.**

5.  **استعادة نماذج Ollama:**
    *   **الأمر الأول (حذف المجلد المؤقت):**
        ```bash
        rmdir /s /q "%USERPROFILE%\.ollama"
        ```
        *(هذا الأمر يحذف مجلد .ollama الفارغ الذي أنشأه التثبيت. اضغط Enter. إذا قال "File not found"، فهذا طبيعي، أكمل.)*

    *   **الأمر الثاني (الذهاب إلى سطح المكتب):**
        ```bash
        cd %USERPROFILE%\Desktop\ai
        ```

    *   **الأمر الثالث (فك ضغط نماذجك):**
        ```bash
        "C:\Program Files\7-Zip\7z.exe" x .ollama.rar -o"%USERPROFILE%"
        ```
        *(هذا الأمر يستخدم 7-Zip لفك ضغط ملف نماذجك مباشرة في مجلد المستخدم الصحيح. تأكد من أن اسم الملف هو `.ollama.rar` أو عدّله إذا كان `.ollama.7z`)*

6.  **استعادة بيئة Conda:**
    *   **الأمر الرابع (الذهاب إلى مجلد بيئات Conda):**
        ```bash
        cd %USERPROFILE%\miniconda3\envs
        ```
        *(استبدل `%USERPROFILE%` بـ `C:\Users\YourUsername` إذا لم يعمل الأمر مباشرة)*

    *   **الأمر الخامس (فك ضغط بيئتك):**
        ```bash
        tar -xzf "%USERPROFILE%\Desktop\ai\support_env.tar"
        ```
        *(هذا الأمر يفك ضغط ملف البيئة الكاملة في المكان الصحيح. انتظر حتى ينتهي.)*

7.  **إعداد Poppler:**
    *   **الأمر السادس (نسخ المجلد إلى C):**
        ```bash
        xcopy "%USERPROFILE%\Desktop\ai\Release-25.07.0-0" "C:\Release-25.07.0-0" /E /I
        ```
        *(هذا الأمر ينسخ مجلد Poppler بالكامل إلى القرص C. سيطلب منك تأكيداً، اضغط حرف `D` إذا سأل هل هو ملف أم مجلد.)*

---

#### **المرحلة الثالثة: الاختبار والتشغيل النهائي**

**ملاحظة:** أغلق نافذة Anaconda Prompt الحالية وافتح نافذة **جديدة** لضمان تحديث كل المسارات.

8.  **اختبار كل شيء:**
    *   **الأمر السابع (اختبار Ollama):**
        ```bash
        ollama list
        ```
        *(**النتيجة المتوقعة:** يجب أن ترى قائمة بنماذج `qwen3` الخاصة بك. هذا هو تأكيد نجاح استعادة النماذج.)*

    *   **الأمر الثامن (اختبار Conda):**
        ```bash
        conda env list
        ```
        *(**النتيجة المتوقعة:** يجب أن ترى بيئة `support_env` مدرجة في القائمة.)*

9.  **تشغيل التطبيق:**
    *   **الأمر التاسع (تفعيل البيئة):**
        ```bash
        conda activate support_env
        ```
        *(**النتيجة المتوقعة:** ستظهر `(support_env)` في بداية سطر الأوامر.)*

    *   **الأمر العاشر (الذهاب إلى مجلد مشروعك):**
        ```bash
        cd %USERPROFILE%\Desktop\ai\support_service_platform
        ```

    *   **الأمر الحادي عشر (تشغيل التطبيق):**
        *   استخدم الأمر المعتاد لتشغيل تطبيقك. على سبيل المثال، إذا كنت تستخدم FastAPI:
            ```bash
            uvicorn main:app
            ```
        *   أو إذا كان مجرد سكربت بايثون:
            ```bash
            python your_main_script.py
            ```

بهذه الأوامر الأحد عشر، تكون قد نقلت نظامك بالكامل من مرحلة "صندوق على سطح المكتب" إلى "نظام يعمل بكامل طاقته" في بيئة معزولة تماماً.